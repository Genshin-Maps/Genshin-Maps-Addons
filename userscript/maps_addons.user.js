// ==UserScript==
// @name            Genshin Maps Addons
// @name:ko         원신 맵스 부가기능
// @namespace       genshin-maps-app/addons
// @version         1.1.7
// @author          Genshin-Maps
// @description     Adds several add-ons to Genshin Maps.
// @description:ko  원신 맵스에 여러 부가기능을 추가합니다.
// @license         MIT
// @icon            https://genshin.gamedot.org/asset/xapp-icon128.png.pagespeed.ic.zyAE0ntk9a.webp
// @source          https://github.com/Genshin-Maps/Genshin-Maps-Addons
// @downloadURL     https://github.com/Genshin-Maps/Genshin-Maps-Addons/raw/gh-pages/userscript/maps_addons.user.js
// @updateURL       https://github.com/Genshin-Maps/Genshin-Maps-Addons/raw/gh-pages/userscript/maps_addons.user.js
// @match           https://genshin.gamedot.org/?mid=genshinmaps
// @connect         raw.githubusercontent.com
// @connect         github.com
// @connect         hoyoverse.com
// @grant           GM_xmlhttpRequest
// @grant           unsafeWindow
// ==/UserScript==

(function () {
	'use strict';

	var _documentCurrentScript = typeof document !== 'undefined' ? document.currentScript : null;
	!function(){try{if("undefined"!=typeof document){var e=document.createElement("style");e.appendChild(document.createTextNode('.hidden-search,.vsb-menu li[data-parent].closed{display:none!important}.vsb-menu li[data-parent].open:not(.hidden-search){display:block!important}.vsb-menu{cursor:pointer;z-index:1000;display:block;visibility:hidden;position:absolute;border:1px solid #b2b2b2;background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,.15);box-shadow:0 6px 12px #0000002d;border-radius:4px;font-size:11px}.vsb-js-search-zone{position:absolute;z-index:1001;width:80%;min-height:1.8em;padding:2px;background-color:#fff}.vsb-js-search-zone input{border:1px solid grey;margin-left:2px;width:96%;border-radius:4px;height:25px!important}.vsb-main{position:relative;display:inline-block;vertical-align:middle;text-align:left}.vsb-menu li:hover{background:linear-gradient(#f5f5f5,#e8e8e8)}.vsb-menu ul{-webkit-user-select:none;user-select:none;list-style:none;white-space:nowrap;margin:4px 0 0;padding-left:10px;padding-right:10px;padding-bottom:3px;color:#333;cursor:pointer;overflow-y:auto}.vsb-menu li.disabled,.vsb-menu li.overflow{cursor:not-allowed;opacity:.3;background-color:#999}.vsb-menu li.short{overflow:hidden;text-overflow:ellipsis}.vsb-main button{min-width:120px;border-radius:0;width:100%;text-align:left;z-index:1;color:#333;background:white!important;border:1px solid #999!important;line-height:20px;font-size:14px;padding:6px 12px}.vsb-main button.disabled{cursor:not-allowed;opacity:.65}.vsb-main .title{margin-right:6px;-webkit-user-select:none;user-select:none}.vsb-main li:hover{background:linear-gradient(#f5f5f5,#e8e8e8)}.vsb-main ul{white-space:nowrap}.vsb-menu li{font-size:14px;background-color:#fff;min-height:1.4em;padding:.2em 2em .2em 1em}.vsb-menu li.grouped-option b{display:inline-block;font-size:15px;margin-left:10px;transform:translate(-18px)}.vsb-menu li.grouped-option.open span{display:inline-block;font-size:inherit;margin-top:-2px;height:8px;width:8px;transform:translate(-38px) rotate(45deg);border-bottom:3px solid black;border-right:3px solid black;border-radius:2px}.vsb-menu li.grouped-option.closed span{display:inline-block;font-size:inherit;height:8px;width:8px;transform:translate(-38px) rotate(-45deg);border-bottom:3px solid black;border-right:3px solid black;border-radius:2px}.vsb-menu li.grouped-option i{display:inline-block;font-size:inherit;float:left;font-weight:700;margin-left:22px;margin-right:2px;height:11px;width:8px;border:1px solid;border-radius:3px;padding:1px 3px 2px;margin-top:0;color:#000}.vsb-menu li.grouped-option.checked i:after{content:"";font-size:inherit;color:#333;float:left;margin-left:0;display:inline-block;transform:rotate(45deg);height:8px;width:5px;border-bottom:3px solid black;border-right:3px solid black}.vsb-menu :not(.multi) li.active{margin-left:7px}.vsb-menu :not(.multi) li.active:before{content:"";display:inline-block;font-size:inherit;margin-left:-18px;transform:rotate(45deg);height:10px;width:5px;border-bottom:3px solid black;border-right:3px solid black;border-radius:2px}.vsb-menu .multi li{font-size:14px;background-color:#fff;min-height:1.4em;padding:.2em 2em .2em 26px}.vsb-menu .multi li.grouped-option{font-size:15px;padding-left:5px}.vsb-menu .multi li.grouped-option:hover{font-weight:700;text-decoration:underline;color:#341f70}.vsb-menu .multi li:not(.grouped-option):before{content:"";display:inline-block;font-size:inherit;float:left;font-weight:700;margin-left:-22px;margin-right:2px;border:1px solid;border-radius:3px;padding:7px;margin-top:0;color:#000}.vsb-menu .multi li:not(.grouped-option).active:after{content:"";font-size:inherit;color:#333;float:left;margin-left:-18px;display:inline-block;transform:rotate(45deg);margin-top:1px;height:8px;width:5px;border-bottom:3px solid black;border-right:3px solid black}.caret{display:inline-block;width:0;height:0;margin-left:2px;vertical-align:middle;border-top:4px dashed;border-top:4px solid;border-right:4px solid transparent;border-left:4px solid transparent}.vsb-menu li[data-parent]{padding-left:50px!important}.maps-addons{-webkit-user-select:none;user-select:none;display:block;position:fixed;right:20px;bottom:65px}.maps-addons>.hide{display:none}#mapsLayerBackground{transition:filter .2s ease-in}#mapsLayerBackground.grayscale{filter:contrast(.7) brightness(.4) grayscale(.8)}@media screen and (max-width: 1280px) and (min-width: 768px) and (min-height: 500px){#mapsAddonsMenu.close~.maps-addons{bottom:45px!important}#mapsAddonsMenu:not(.close)~.maps-addons{bottom:120px!important}}@media screen and (max-width: 768px) and (orientation: portrait),only screen and (max-height: 500px) and (orientation: landscape){.maps-addons{right:5px!important;bottom:11.5vh!important}}@media screen and (max-height: 500px) and (min-width: 400px){.maps-addons{right:16vh!important;bottom:10px!important}.maps-addons-switch,.vsb-main button{width:15vh!important;height:7.5vh!important}.maps-addons-switch-label{width:15vh!important;font-size:12px!important;padding-top:3px!important;padding-bottom:1px!important}}.maps-addons-switch{width:72px;height:36px;background-image:url(data:image/png;base64,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);background-position:50%;background-repeat:no-repeat;background-size:100%;border:none;background-color:transparent;cursor:pointer}.maps-addons-switch.on{background-image:url(data:image/png;base64,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)}.maps-addons-switch-label{width:77px;color:#ece5d8;text-shadow:-1px 0 #3b4354,0 1px #3b4354,1px 0 #3b4354,0 -1px #3b4354;font-size:18px;padding-top:6px;padding-bottom:2px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.vsb-main button{border:1.5px solid #ece5d8!important;border-radius:20px;min-width:unset;width:72px;height:36px;background:rgb(211,188,142)!important;padding:2px 6px;color:#ece5d8;text-shadow:-1px 0 #3b4354,0 1px #3b4354,1px 0 #3b4354,0 -1px #3b4354;font-size:11px;text-align:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.vsb-menu ul{-webkit-user-select:none;user-select:none;list-style:none;white-space:nowrap;margin:4px 0 0;padding-left:5px;padding-right:5px;padding-bottom:3px;color:#333;cursor:pointer;overflow-y:auto}.vsb-menu .multi li{font-size:14px;min-height:1.4em;padding:.2em 2em .2em 26px;background-color:transparent}#mapsLayerUnderground.svelte-lvoly4.svelte-lvoly4{position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden}#mapsLayerUnderground.svelte-lvoly4 .underground-image.svelte-lvoly4{position:absolute;background-size:100%;z-index:-1;opacity:1;transition:filter .2s ease-in,opacity .2s ease-in;top:0;left:0;visibility:hidden;content-visibility:auto;-webkit-user-select:none;user-select:none}#mapsLayerUnderground.selected.svelte-lvoly4 .underground-image.svelte-lvoly4{visibility:hidden;opacity:0}#mapsLayerUnderground.selected.svelte-lvoly4 .underground-image.selected.svelte-lvoly4{visibility:visible;opacity:1;z-index:0}#mapsLayerUnderground.svelte-lvoly4 .underground-selection.svelte-lvoly4{position:absolute;z-index:5;background:white;width:fit-content;height:fit-content;-webkit-user-select:auto;user-select:auto;display:block;border-radius:15px 15px 0 0;content-visibility:auto}#mapsLayerUnderground.svelte-lvoly4 .underground-selection .underground-selection-head.svelte-lvoly4{padding:5px;height:20px;min-width:200px;min-height:25px;text-align:center;border-radius:15px 15px 0 0;background:#d3bc8e;cursor:move}#mapsLayerUnderground.svelte-lvoly4 .underground-selection .underground-selection-body .underground-selection-item.svelte-lvoly4{display:block;width:100%;border:none;text-align:left;padding:5px;background:white;cursor:pointer;min-height:24px}#mapsLayerUnderground.svelte-lvoly4 .underground-selection .underground-selection-body .underground-selection-item.svelte-lvoly4:hover,#mapsLayerUnderground.svelte-lvoly4 .underground-selection .underground-selection-body .underground-selection-item.selected.svelte-lvoly4{background:#f7f7d8}#mapsLayerUnderground.svelte-lvoly4 .underground-selection .underground-selection-body .underground-selection-item.svelte-lvoly4:not(:first-child){border-top:1px solid #d3bc8e}')),document.head.appendChild(e);}}catch(t){console.error("vite-plugin-css-injected-by-js",t);}}();
	var t=Object.defineProperty,e=(e,s,n)=>(((e,s,n)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n;})(e,"symbol"!=typeof s?s+"":s,n),n);function s(){}function n(t){return t()}function i(){return Object.create(null)}function o(t){t.forEach(n);}function a(t){return "function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t){let e;return function(t,...e){if(null==t){for(const t of e)t(void 0);return s}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}(t,(t=>e=t))(),e}function c(t){return t&&a(t.destroy)?t.destroy:s}const d="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function u(t,e){t.appendChild(e);}function h(t,e,s){t.insertBefore(e,s||null);}function p(t){t.parentNode&&t.parentNode.removeChild(t);}function f(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function g(){return m(" ")}function v(){return m("")}function b(t,e,s,n){return t.addEventListener(e,s,n),()=>t.removeEventListener(e,s,n)}function y(t,e,s){null==s?t.removeAttribute(e):t.getAttribute(e)!==s&&t.setAttribute(e,s);}function x(t,e){e=""+e,t.data!==e&&(t.data=e);}function A(t,e){t.value=null==e?"":e;}function S(t,e,s,n){null==s?t.style.removeProperty(e):t.style.setProperty(e,s,n?"important":"");}let E;function L(t){E=t;}function O(){if(!E)throw new Error("Function called outside component initialization");return E}function w(t){O().$$.on_mount.push(t);}function $(t){O().$$.on_destroy.push(t);}const k=[],M=[];let _=[];const P=[],C=Promise.resolve();let T=!1;function H(t){_.push(t);}const I=new Set;let N=0;function j(){if(0!==N)return;const t=E;do{try{for(;N<k.length;){const t=k[N];N++,L(t),W(t.$$);}}catch(e){throw k.length=0,N=0,e}for(L(null),k.length=0,N=0;M.length;)M.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];I.has(e)||(I.add(e),e());}_.length=0;}while(k.length);for(;P.length;)P.pop()();T=!1,I.clear(),L(t);}function W(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(H);}}const q=new Set;let R;function z(t,e){t&&t.i&&(q.delete(t),t.i(e));}function U(t,e,s,n){if(t&&t.o){if(q.has(t))return;q.add(t),R.c.push((()=>{q.delete(t),n&&(s&&t.d(1),n());})),t.o(e);}else n&&n();}function D(t){return void 0!==(null==t?void 0:t.length)?t:Array.from(t)}function V(t,e){t.d(1),e.delete(t.key);}function B(t){t&&t.c();}function F(t,e,s){const{fragment:i,after_update:r}=t.$$;i&&i.m(e,s),H((()=>{const e=t.$$.on_mount.map(n).filter(a);t.$$.on_destroy?t.$$.on_destroy.push(...e):o(e),t.$$.on_mount=[];})),r.forEach(H);}function X(t,e){const s=t.$$;null!==s.fragment&&(!function(t){const e=[],s=[];_.forEach((n=>-1===t.indexOf(n)?e.push(n):s.push(n))),s.forEach((t=>t())),_=e;}(s.after_update),o(s.on_destroy),s.fragment&&s.fragment.d(e),s.on_destroy=s.fragment=null,s.ctx=[]);}function Y(t,e){-1===t.$$.dirty[0]&&(k.push(t),T||(T=!0,C.then(j)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31;}function G(t,e,n,a,r,l,c=null,d=[-1]){const u=E;L(t);const h=t.$$={fragment:null,ctx:[],props:l,update:s,not_equal:r,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:i(),dirty:d,skip_bound:!1,root:e.target||u.$$.root};c&&c(h.root);let f=!1;if(h.ctx=n?n(t,e.props||{},((e,s,...n)=>{const i=n.length?n[0]:s;return h.ctx&&r(h.ctx[e],h.ctx[e]=i)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](i),f&&Y(t,e)),s})):[],h.update(),f=!0,o(h.before_update),h.fragment=!!a&&a(h.ctx),e.target){if(e.hydrate){const t=(m=e.target,Array.from(m.childNodes));h.fragment&&h.fragment.l(t),t.forEach(p);}else h.fragment&&h.fragment.c();e.intro&&z(t.$$.fragment),F(t,e.target,e.anchor),j();}var m;L(u);}class J{constructor(){e(this,"$$"),e(this,"$$set");}$destroy(){X(this,1),this.$destroy=s;}$on(t,e){if(!a(e))return s;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1);}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1);}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const Z=[];function K(t,e=s){let n;const i=new Set;function o(e){if(r(t,e)&&(t=e,n)){const e=!Z.length;for(const s of i)s[1](),Z.push(s,t);if(e){for(let t=0;t<Z.length;t+=2)Z[t][0](Z[t+1]);Z.length=0;}}}function a(e){o(e(t));}return {set:o,update:a,subscribe:function(r,l=s){const c=[r,l];return i.add(c),1===i.size&&(n=e(o,a)||s),r(t),()=>{i.delete(c),0===i.size&&n&&(n(),n=null);}}}}const Q=K(!1),tt=K(!0),et=K(!1),st=function(){let t=0,e=[];return {set:s=>(e.push({offset:++t,ptr:s}),e[e.length-1].offset),remove(t){const s=e.filter((e=>e.offset!=t));e=s.splice(0);},closeAllButMe(t){e.forEach((e=>{e.offset!=t&&e.ptr.closeOrder();}));}}}();class nt{constructor(t,s){if(e(this,"instanceOffset"),e(this,"domSelector"),e(this,"root"),e(this,"rootToken"),e(this,"main"),e(this,"button"),e(this,"title"),e(this,"isMultiple"),e(this,"multipleSize"),e(this,"currentOptgroup"),e(this,"drop"),e(this,"options"),e(this,"listElements"),e(this,"isDisabled"),e(this,"ul"),e(this,"ulmaxWidth"),e(this,"maxOptionWidth"),e(this,"maxSelect"),e(this,"onInitSize"),e(this,"forbidenAttributes"),e(this,"forbidenClasses"),e(this,"userOptions"),e(this,"keepInlineStyles"),e(this,"keepInlineCaretStyles"),e(this,"closeOrder"),e(this,"getCssArray"),e(this,"init"),e(this,"getResult"),e(this,"createTree"),this.instanceOffset=st.set(this),this.domSelector=t,this.root=document.querySelector(t),this.rootToken=null,this.main,this.button,this.title,this.isMultiple=this.root.hasAttribute("multiple"),this.multipleSize=this.isMultiple&&this.root.hasAttribute("size")?parseInt(this.root.getAttribute("size")):-1,this.currentOptgroup=0,this.drop,this.options,this.listElements,this.isDisabled=!1,this.ul=void 0,this.ulmaxWidth=280,this.maxOptionWidth=1/0,this.maxSelect=1/0,this.onInitSize=-1,this.forbidenAttributes=["class","selected","disabled","data-text","data-value"],this.forbidenClasses=["active","disabled"],this.userOptions={maxWidth:500,minWidth:-1,maxHeight:400,translations:{all:"All",item:"item",items:"items",selectAll:"Select All",clearAll:"Clear All"},placeHolder:"",stayOpen:!1,disableSelectAll:!1,buttonItemsSeparator:","},this.keepInlineStyles=!0,this.keepInlineCaretStyles=!0,s){if(null!=s.itemsSeparator&&(this.userOptions.buttonItemsSeparator=s.itemsSeparator),null!=s.maxWidth&&(this.userOptions.maxWidth=s.maxWidth),null!=s.minWidth&&(this.userOptions.minWidth=s.minWidth),null!=s.maxHeight&&(this.userOptions.maxHeight=s.maxHeight),null!=s.translations)for(const t in s.translations)Object.prototype.hasOwnProperty.call(s.translations,t)&&this.userOptions.translations[t]&&(this.userOptions.translations[t]=s.translations[t]);null!=s.placeHolder&&(this.userOptions.placeHolder=s.placeHolder),null!=s.stayOpen&&(this.userOptions.stayOpen=s.stayOpen),null!=s.disableSelectAll&&(this.userOptions.disableSelectAll=s.disableSelectAll),null!=s.maxSelect&&!isNaN(s.maxSelect)&&s.maxSelect>=1&&(this.maxSelect=s.maxSelect,this.userOptions.disableSelectAll=!0),null!=s.maxOptionWidth&&!isNaN(s.maxOptionWidth)&&s.maxOptionWidth>=20&&(this.maxOptionWidth=s.maxOptionWidth,this.ulmaxWidth=s.maxOptionWidth+60),null!=s.keepInlineStyles&&(this.keepInlineStyles=s.keepInlineStyles),null!=s.keepInlineCaretStyles&&(this.keepInlineCaretStyles=s.keepInlineCaretStyles);}this.closeOrder=function(){this.userOptions.stayOpen||(this.drop.style.visibility="hidden");},this.getCssArray=function(t){let e=[];return ".vsb-main button"===t&&(e=[{key:"min-width",value:"120px"},{key:"border-radius",value:"0"},{key:"width",value:"100%"},{key:"text-align",value:"left"},{key:"z-index",value:"1"},{key:"color",value:"#333"},{key:"background",value:"white !important"},{key:"border",value:"1px solid #999 !important"},{key:"line-height",value:"20px"},{key:"font-size",value:"14px"},{key:"padding",value:"6px 12px"}]),function(t){let e="";return t.forEach((t=>{e+=t.key+":"+t.value+";";})),e}(e)},this.init=function(){this.createTree();},this.getResult=function(){const t=[];return this.root.querySelectorAll("option").forEach((e=>{e.selected&&t.push(e.value);})),t},this.createTree=()=>{this.rootToken=this.domSelector.replace(/[^A-Za-z0-9]+/,""),this.root.style.display="none";const t=document.getElementById("btn-group-"+this.rootToken);if(t&&t.remove(),this.main=document.createElement("div"),this.root.parentNode.insertBefore(this.main,this.root.nextSibling),this.main.classList.add("vsb-main"),this.main.setAttribute("id","btn-group-"+this.rootToken),this.userOptions.stayOpen&&(this.main.style.minHeight=this.userOptions.maxHeight+10+"px"),this.userOptions.stayOpen)this.button=document.createElement("div");else if(this.button=document.createElement("button"),this.keepInlineStyles){const t=this.getCssArray(".vsb-main button");this.button.setAttribute("style",t);}this.button.style.maxWidth=this.userOptions.maxWidth+"px",-1!==this.userOptions.minWidth&&(this.button.style.minWidth=this.userOptions.minWidth+"px"),this.main.appendChild(this.button),this.title=document.createElement("span"),this.button.appendChild(this.title),this.title.classList.add("title");const e=document.createElement("span");if(this.button.appendChild(e),e.classList.add("caret"),this.keepInlineCaretStyles&&(e.style.position="absolute",e.style.right="8px",e.style.marginTop="8px"),this.userOptions.stayOpen&&(e.style.display="none",this.title.style.paddingLeft="20px",this.title.style.fontStyle="italic",this.title.style.verticalAlign="20%"),this.drop=document.createElement("div"),this.main.appendChild(this.drop),this.drop.classList.add("vsb-menu"),this.drop.style.zIndex=String(2e3-this.instanceOffset),this.ul=document.createElement("ul"),this.drop.appendChild(this.ul),this.ul.style.maxHeight=this.userOptions.maxHeight+"px",this.ul.style.maxWidth=this.ulmaxWidth+"px",this.isMultiple&&(this.ul.classList.add("multi"),!this.userOptions.disableSelectAll)){const t=document.createElement("option");t.setAttribute("value","all"),t.innerText=this.userOptions.translations.selectAll,this.root.insertBefore(t,this.root.hasChildNodes()?this.root.childNodes[0]:null);}let s="",n="",i=0;this.options=document.querySelectorAll(this.domSelector+" > option"),Array.from(this.options).forEach((t=>{const e=t.textContent,o=t.value;let a;t.hasAttributes()&&(a=Array.from(t.attributes).filter((t=>-1===this.forbidenAttributes.indexOf(t.name))));let r=t.getAttribute("class");r=r?r.split(" ").filter((t=>-1===this.forbidenClasses.indexOf(t))):[];const l=document.createElement("li"),c=t.hasAttribute("selected"),d=t.hasAttribute("disabled");this.ul.appendChild(l),l.setAttribute("data-value",o),l.setAttribute("data-text",e),void 0!==a&&a.forEach((t=>{l.setAttribute(t.name,t.value);})),r.forEach((t=>{l.classList.add(t);})),this.maxOptionWidth<1/0&&(l.classList.add("short"),l.style.maxWidth=this.maxOptionWidth+"px"),c&&(i++,s+=n+e,n=this.userOptions.buttonItemsSeparator,l.classList.add("active"),this.isMultiple||(this.title.textContent=e,0!=r.length&&r.forEach((t=>{this.title.classList.add(t);})))),d&&l.classList.add("disabled"),l.appendChild(document.createTextNode(" "+e));}));if(this.options.length-Number(!this.userOptions.disableSelectAll)==i){const t=this.userOptions.translations.all;s=t;}else if(-1!=this.multipleSize&&i>this.multipleSize){const t=1===i?this.userOptions.translations.item:this.userOptions.translations.items;s=i+" "+t;}this.isMultiple&&(this.title.innerHTML=s),""!=this.userOptions.placeHolder&&""==this.title.textContent&&(this.title.textContent=this.userOptions.placeHolder),this.listElements=this.drop.querySelectorAll("li:not(.grouped-option)"),this.userOptions.stayOpen?(this.drop.style.visibility="visible",this.drop.style.boxShadow="none",this.drop.style.minHeight=this.userOptions.maxHeight+10+"px",this.drop.style.position="relative",this.drop.style.left="0px",this.drop.style.top="0px",this.button.style.border="none"):this.main.addEventListener("click",(t=>{this.isDisabled||(this.drop.style.visibility="visible",document.addEventListener("click",o),t.preventDefault(),t.stopPropagation(),this.userOptions.stayOpen||st.closeAllButMe(this.instanceOffset));})),this.drop.addEventListener("click",(t=>{if(this.isDisabled)return;const e=t.target;if("INPUT"===e.tagName)return;const s="SPAN"===e.tagName,n="I"===e.tagName,i=e.parentElement;if(!i.hasAttribute("data-value")&&i.classList.contains("grouped-option")){if(!s&&!n)return;let t,e;if(n)this.checkUncheckFromParent(i);else {i.classList.contains("open")?(t="open",e="closed"):(t="closed",e="open"),i.classList.remove(t),i.classList.add(e);this.drop.querySelectorAll("[data-parent='"+i.id+"']").forEach((s=>{s.classList.remove(t),s.classList.add(e);}));}return}const a=e.getAttribute("data-value"),r=e.getAttribute("data-text"),l=e.getAttribute("class");if(!(l&&-1!=l.indexOf("disabled")||l&&-1!=l.indexOf("overflow")))if("all"!==a){if(this.isMultiple){let t=!1;l&&(t=-1!=l.indexOf("active")),t?e.classList.remove("active"):e.classList.add("active"),e.hasAttribute("data-parent")&&this.checkUncheckFromChild(e);let s="",n="",i=0,o=0;for(let e=0;e<this.options.length;e++)o++,this.options[e].value==a&&(this.options[e].selected=!t),this.options[e].selected&&(i++,s+=n+this.options[e].textContent,n=this.userOptions.buttonItemsSeparator);if(o==i-Number(!this.userOptions.disableSelectAll)){s=this.userOptions.translations.all;}else if(-1!=this.multipleSize&&i>this.multipleSize){s=i+" "+(1===i?this.userOptions.translations.item:this.userOptions.translations.items);}this.title.textContent=s,this.checkSelectMax(i),this.checkUncheckAll(),this.privateSendChange();}else this.root.value=a,this.title.textContent=r,l?this.title.setAttribute("class",l+" title"):this.title.setAttribute("class","title"),Array.from(this.listElements).forEach((t=>{t.classList.remove("active");})),""!=r&&e.classList.add("active"),this.privateSendChange(),this.userOptions.stayOpen||o();t.preventDefault(),t.stopPropagation(),""!=this.userOptions.placeHolder&&""==this.title.textContent&&(this.title.textContent=this.userOptions.placeHolder);}else e.hasAttribute("data-selected")&&"true"===e.getAttribute("data-selected")?this.setValue("none"):this.setValue("all");}));const o=()=>{document.removeEventListener("click",o),this.drop.style.visibility="hidden";};},this.init(),this.checkUncheckAll();}disableItems(t){const e=[];"string"==it(t)&&(t=t.split(",")),"array"==it(t)&&Array.from(this.options).forEach((s=>{-1!=t.indexOf(s.value)&&(e.push(s.value),s.setAttribute("disabled",""));})),Array.from(this.listElements).forEach((t=>{const s=t.getAttribute("data-value");-1!=e.indexOf(s)&&t.classList.add("disabled");}));}checkSelectMax(t){this.maxSelect!=1/0&&this.isMultiple&&(this.maxSelect<=t?Array.from(this.listElements).forEach((t=>{t.hasAttribute("data-value")&&(t.classList.contains("disabled")||t.classList.contains("active")||t.classList.add("overflow"));})):Array.from(this.listElements).forEach((t=>{t.classList.contains("overflow")&&t.classList.remove("overflow");})));}checkUncheckFromChild(t){const e=t.getAttribute("data-parent"),s=document.getElementById(e);if(!this.isMultiple)return;const n=this.drop.querySelectorAll("li"),i=Array.from(n).filter((function(t){return t.hasAttribute("data-parent")&&t.getAttribute("data-parent")==e&&!t.classList.contains("hidden-search")}));let o=0;const a=i.length;0!=a&&(i.forEach((function(t){t.classList.contains("active")&&o++;})),o===a||0===o?0===o?s.classList.remove("checked"):s.classList.add("checked"):s.classList.remove("checked"));}checkUncheckFromParent(t){const e=t.id;if(!this.isMultiple)return;const s=this.drop.querySelectorAll("li"),n=Array.from(s).filter((function(t){return t.hasAttribute("data-parent")&&t.getAttribute("data-parent")==e&&!t.classList.contains("hidden-search")}));let i=0;const o=n.length;0!=o&&(n.forEach((function(t){t.classList.contains("active")&&i++;})),i===o||0===i?(n.forEach((function(t){const e=document.createEvent("HTMLEvents");e.initEvent("click",!0,!1),t.dispatchEvent(e);})),0===i?t.classList.add("checked"):t.classList.remove("checked")):(t.classList.remove("checked"),n.forEach((function(t){if(!t.classList.contains("active")){const e=document.createEvent("HTMLEvents");e.initEvent("click",!0,!1),t.dispatchEvent(e);}}))));}checkUncheckAll(){if(!this.isMultiple)return;let t=0,e=0,s=0,n=null;null!=this.listElements&&(Array.from(this.listElements).forEach((i=>{i.hasAttribute("data-value")&&("all"===i.getAttribute("data-value")&&(n=i),"all"===i.getAttribute("data-value")||i.classList.contains("hidden-search")||i.classList.contains("disabled")||(e++,t+=i.classList.contains("active")?1:0),"all"===i.getAttribute("data-value")||i.classList.contains("disabled")||s++);})),n&&(t===e?(t===s&&(this.title.textContent=this.userOptions.translations.all),n.classList.add("active"),n.innerText=this.userOptions.translations.clearAll,n.setAttribute("data-selected","true")):0===t&&(this.title.textContent=this.userOptions.placeHolder,n.classList.remove("active"),n.innerText=this.userOptions.translations.selectAll,n.setAttribute("data-selected","false"))));}setValue(t){const e=this.drop.querySelectorAll("li");if(null==t||null==t||""==t)this.empty();else if(this.isMultiple){"string"==it(t)&&("all"===t?(t=[],Array.from(e).forEach((e=>{if(e.hasAttribute("data-value")){const s=e.getAttribute("data-value");"all"!==s?(e.classList.contains("hidden-search")||e.classList.contains("disabled")||t.push(e.getAttribute("data-value")),e.classList.contains("active")&&(e.classList.contains("hidden-search")||e.classList.contains("disabled"))&&t.push(s)):e.classList.add("active");}else e.classList.contains("grouped-option")&&e.classList.add("checked");}))):"none"===t?(t=[],Array.from(e).forEach((e=>{if(e.hasAttribute("data-value")){const s=e.getAttribute("data-value");"all"!==s&&e.classList.contains("active")&&(e.classList.contains("hidden-search")||e.classList.contains("disabled"))&&t.push(s);}else e.classList.contains("grouped-option")&&e.classList.remove("checked");}))):t=t.split(","));const s=[];if("array"==it(t)){Array.from(this.options).forEach((e=>{-1!==t.indexOf(e.value)?(e.selected=!0,s.push(e.value)):e.selected=!1;}));let n="",i="",o=0,a=0;if(Array.from(e).forEach((t=>{"all"!==t.getAttribute("data-value")&&a++,-1!=s.indexOf(t.getAttribute("data-value"))?(t.classList.add("active"),o++,n+=i+t.getAttribute("data-text"),i=this.userOptions.buttonItemsSeparator):t.classList.remove("active");})),a==o-Number(!this.userOptions.disableSelectAll)){const t=this.userOptions.translations.all;n=t;}else if(-1!=this.multipleSize&&o>this.multipleSize){const t=1===o?this.userOptions.translations.item:this.userOptions.translations.items;n=o+" "+t;}this.title.textContent=n,this.privateSendChange();}this.checkUncheckAll();}else {let s=!1,n="",i="";Array.from(e).forEach((e=>{e.getAttribute("data-value")==t?(e.classList.add("active"),s=!0,n=e.getAttribute("data-text")):e.classList.remove("active");})),Array.from(this.options).forEach((e=>{e.value==t?(e.selected=!0,i=e.getAttribute("class"),i||(i="")):e.selected=!1;})),s&&(this.title.textContent=n,""!=this.userOptions.placeHolder&&""==this.title.textContent&&(this.title.textContent=this.userOptions.placeHolder),""!=i?this.title.setAttribute("class",i+" title"):this.title.setAttribute("class","title"));}}privateSendChange(){const t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.root.dispatchEvent(t);}empty(){Array.from(this.listElements).forEach((t=>{t.classList.remove("active");}));const t=this.drop.querySelectorAll("li.grouped-option");t&&Array.from(t).forEach((t=>{t.classList.remove("checked");})),Array.from(this.options).forEach((t=>{t.selected=!1;})),this.title.textContent="",""!=this.userOptions.placeHolder&&""==this.title.textContent&&(this.title.textContent=this.userOptions.placeHolder),this.checkUncheckAll(),this.privateSendChange();}destroy(){const t=document.getElementById("btn-group-"+this.rootToken);t&&(st.remove(this.instanceOffset),t.remove(),this.root.style.display="inline-block");}disable(){this.main.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation();}));const t=document.getElementById("btn-group-"+this.rootToken);if(t){const e=t.querySelector("button");e&&e.classList.add("disabled"),this.isDisabled=!0;}}enable(){const t=document.getElementById("btn-group-"+this.rootToken);if(t){const e=t.querySelector("button");e&&e.classList.remove("disabled"),this.isDisabled=!1;}}}function it(t){return Object.prototype.toString.call(t).replace("[object ","").replace("]","").toLowerCase()}var ot=(()=>"undefined"!=typeof unsafeWindow?unsafeWindow:void 0)();function at(t){let e,n,i,o,a,r,l,c,d,m,v,x;return {c(){e=f("div"),n=f("div"),n.textContent="상자 필터",i=g(),o=f("select"),a=f("option"),a.textContent="평범한",r=f("option"),r.textContent="정교한",l=f("option"),l.textContent="진귀한",c=f("option"),c.textContent="화려한",d=f("option"),d.textContent="신묘한",y(n,"class","maps-addons-switch-label"),a.__value="평범한",A(a,a.__value),S(a,"color","gray"),r.__value="정교한",A(r,r.__value),S(r,"color","#9ee0d4"),l.__value="진귀한",A(l,l.__value),S(l,"color","#e6ba7b"),c.__value="화려한",A(c,c.__value),S(c,"color","#ff6c38"),d.__value="신묘한",A(d,d.__value),S(d,"color","#accb29"),y(o,"id","chest-filter"),o.multiple=!0,y(e,"class",m="chest-pin "+(t[0]?"":"hide"));},m(s,p){h(s,e,p),u(e,n),u(e,i),u(e,o),u(o,a),u(o,r),u(o,l),u(o,c),u(o,d),v||(x=b(o,"change",t[1]),v=!0);},p(t,[s]){1&s&&m!==(m="chest-pin "+(t[0]?"":"hide"))&&y(e,"class",m);},i:s,o:s,d(t){t&&p(e),v=!1,x();}}}function rt(t,e,s){let{chestFilter:n}=e,i=!1;return Q.subscribe((t=>{s(0,i=t),null==n||n.setValue("all");})),w((()=>{var t;s(2,n=new nt("#chest-filter",{placeHolder:"상자 선택",translations:{all:"전체",item:"item",items:"items",selectAll:"전체",clearAll:"전체"},disableSelectAll:!1,keepInlineStyles:!1,keepInlineCaretStyles:!1})),n.setValue("all");for(const e of (null==(t=n.ul)?void 0:t.childNodes)||[]){const t=e;"all"!==t.dataset.value&&(t.textContent+=" ■");}})),t.$$set=t=>{"chestFilter"in t&&s(2,n=t.chestFilter);},[i,function(){ot.setPinObjectRefresh();},n]}class lt extends J{constructor(t){super(),G(this,t,rt,at,r,{chestFilter:2});}}function ct(t){let e,n,i,o,a,r;return {c(){e=f("div"),e.textContent="활성맵 핀",n=g(),i=f("button"),y(e,"class","maps-addons-switch-label"),y(i,"class",o="maps-addons-switch "+(t[0]?"on":""));},m(s,o){h(s,e,o),h(s,n,o),h(s,i,o),a||(r=b(i,"click",t[1]),a=!0);},p(t,[e]){1&e&&o!==(o="maps-addons-switch "+(t[0]?"on":""))&&y(i,"class",o);},i:s,o:s,d(t){t&&(p(e),p(n),p(i)),a=!1,r();}}}function dt(t,e,s){let n;return $(tt.subscribe((t=>{s(0,n=t),ot.setPinObjectRefresh();}))),[n,function(){tt.update((t=>!t));},()=>{if(!n)return;const t=l(et)?':not([data-strata]):not([data-tip*="지하 및 실내 구역 입구"])':"[data-strata]";document.querySelectorAll(`#mapsLayerPoint > .maps-point${t}`).forEach((t=>t.remove()));}]}class ut extends J{constructor(t){super(),G(this,t,dt,ct,r,{removeUnnecessary:2});}get removeUnnecessary(){return this.$$.ctx[2]}}const ht="https://github.com/Genshin-Maps/Genshin-Maps-Addons",pt="undefined"!=typeof window&&window.matchMedia("(hover: none) and (pointer: coarse)").matches;var ft="__monkeyWindow-"+new URL((_documentCurrentScript && _documentCurrentScript.src || new URL('__entry.js', document.baseURI).href)||location.href).origin,mt=document[ft]??window,gt=(()=>mt.GM)(),vt=(()=>mt.GM_xmlhttpRequest)();const bt=async function(t,e){const s=vt||gt.xmlHttpRequest;if("function"!=typeof s)throw new DOMException("GM_xmlhttpRequest or GM.xmlHttpRequest is not granted.","NotFoundError");const n=new Request(t,e);if(n.signal.aborted)throw new DOMException("Network request aborted.","AbortError");const i=await n.arrayBuffer(),o=i.byteLength?(new TextDecoder).decode(i):void 0,a=Object.fromEntries(n.headers);return new Headers(null==e?void 0:e.headers).forEach(((t,e)=>{a[e]=t;})),new Promise(((t,e)=>{let i=!1;const r=new Promise((l=>{const{abort:c}=s({method:n.method.toUpperCase(),url:n.url||location.href,headers:a,data:o,redirect:n.redirect,binary:!0,nocache:"no-store"===n.cache,revalidate:"reload"===n.cache,timeout:3e5,responseType:s.RESPONSE_TYPE_STREAM??"blob",overrideMimeType:n.headers.get("Content-Type")??void 0,anonymous:"omit"===n.credentials,onload:({response:t})=>{l(i?null:t);},async onreadystatechange({readyState:s,responseHeaders:o,status:a,statusText:d,finalUrl:u,response:h}){if(s===XMLHttpRequest.DONE)n.signal.removeEventListener("abort",c);else if(s!==XMLHttpRequest.HEADERS_RECEIVED)return;if(i)return void l(null);const p=function(t){const s=new Headers;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var n;const i=t.split(":"),o=null==(n=i.shift())?void 0:n.trim();if(o){const t=i.join(":").trim();try{s.append(o,t);}catch(e){console.warn("Response "+e.message);}}})),s}(o),f=n.url!==u,m=new Response(h instanceof ReadableStream?h:await r,{headers:p,status:a,statusText:d});Object.defineProperties(m,{url:{value:u},type:{value:"basic"},...m.redirected!==f?{redirected:{value:f}}:{},...p.has("set-cookie")||p.has("set-cookie2")?{headers:{value:p}}:{}}),t(m),i=!0;},onerror:({statusText:t,error:s})=>{e(new TypeError(t||s||"Network request failed.")),l(null);},ontimeout(){e(new TypeError("Network request timeout.")),l(null);},onabort(){e(new DOMException("Network request aborted.","AbortError")),l(null);}});n.signal.addEventListener("abort",c);}));}))},{Map:yt}=d;function xt(t,e,s){const n=t.slice();return n[27]=e[s],n[28]=e,n[29]=s,n}function At(t,e,s){const n=t.slice();return n[30]=e[s],n[32]=s,n}function St(t){let e,s,n,i,a=[],r=new yt,l=D(t[5]);const d=t=>t[27];for(let o=0;o<l.length;o+=1){let e=xt(t,l,o),s=d(e);r.set(s,a[o]=Lt(s,e));}return {c(){e=f("div");for(let t=0;t<a.length;t+=1)a[t].c();y(e,"id","mapsLayerUnderground"),y(e,"role","tree"),y(e,"class",s="underground-layer "+(t[2]||t[3]?"selected":"")+" svelte-lvoly4");},m(s,o){h(s,e,o);for(let t=0;t<a.length;t+=1)a[t]&&a[t].m(e,null);t[16](e),n||(i=c(wt.call(null,e,{target:document.getElementById("mapsLayerPoint")})),n=!0);},p(t,n){5997&n[0]&&(l=D(t[5]),a=function(t,e,s,n,i,a,r,l,c,d,u,h){let p=t.length,f=a.length,m=p;const g={};for(;m--;)g[t[m].key]=m;const v=[],b=new Map,y=new Map,x=[];for(m=f;m--;){const t=h(i,a,m),o=s(t);let l=r.get(o);l?n&&x.push((()=>l.p(t,e))):(l=d(o,t),l.c()),b.set(o,v[m]=l),o in g&&y.set(o,Math.abs(m-g[o]));}const A=new Set,S=new Set;function E(t){z(t,1),t.m(l,u),r.set(t.key,t),u=t.first,f--;}for(;p&&f;){const e=v[f-1],s=t[p-1],n=e.key,i=s.key;e===s?(u=e.first,p--,f--):b.has(i)?!r.has(n)||A.has(n)?E(e):S.has(i)?p--:y.get(n)>y.get(i)?(S.add(n),E(e)):(A.add(i),p--):(c(s,r),p--);}for(;p--;){const e=t[p];b.has(e.key)||c(e,r);}for(;f;)E(v[f-1]);return o(x),v}(a,n,d,1,t,l,r,e,V,Lt,null,xt)),12&n[0]&&s!==(s="underground-layer "+(t[2]||t[3]?"selected":"")+" svelte-lvoly4")&&y(e,"class",s);},d(s){s&&p(e);for(let t=0;t<a.length;t+=1)a[t].d();t[16](null),n=!1,i();}}}function Et(t){let e,s,n,i,r,l,d,v,A,E,L,O,w,$,k,M,_,P=t[30].name+"";function C(...e){return t[15](t[27],t[30],...e)}return {c(){e=f("div"),l=g(),d=f("button"),v=m(P),A=g(),y(e,"class",s="underground-image "+(t[2]===t[27].id&&t[3]===t[30].id?"selected":"")+" svelte-lvoly4"),y(e,"data-group",n=t[27].id),y(e,"data-index",i=t[30].id),y(e,"data-name",r=t[30].name),S(e,"background-image",`url(${t[6].get(`${t[27].id}-${t[30].id}`)})`),S(e,"width",Math.floor(t[30].width)+"px"),S(e,"height",Math.floor(t[30].height)+"px"),S(e,"transform","translate( "+Math.floor(t[8](t[30].x)-5)+"px, "+Math.floor(t[9](t[30].y)-3)+"px)"),y(e,"draggable","false"),y(d,"role","tab"),y(d,"aria-selected",E=t[2]===t[27].id&&t[3]===t[30].id),y(d,"tabindex",t[32]),y(d,"class",L="underground-selection-item "+(t[2]===t[27].id&&t[3]===t[30].id?"selected":"")+" svelte-lvoly4"),y(d,"data-group",O=t[27].id),y(d,"data-index",w=t[30].id),y(d,"data-name",$=t[30].name);},m(s,n){h(s,e,n),h(s,l,n),h(s,d,n),u(d,v),u(d,A),M||(_=[c(k=t[7].call(null,d,{target:t[29]})),b(d,"click",C)],M=!0);},p(o,l){t=o,44&l[0]&&s!==(s="underground-image "+(t[2]===t[27].id&&t[3]===t[30].id?"selected":"")+" svelte-lvoly4")&&y(e,"class",s),32&l[0]&&n!==(n=t[27].id)&&y(e,"data-group",n),32&l[0]&&i!==(i=t[30].id)&&y(e,"data-index",i),32&l[0]&&r!==(r=t[30].name)&&y(e,"data-name",r),32&l[0]&&S(e,"background-image",`url(${t[6].get(`${t[27].id}-${t[30].id}`)})`),32&l[0]&&S(e,"width",Math.floor(t[30].width)+"px"),32&l[0]&&S(e,"height",Math.floor(t[30].height)+"px"),32&l[0]&&S(e,"transform","translate( "+Math.floor(t[8](t[30].x)-5)+"px, "+Math.floor(t[9](t[30].y)-3)+"px)"),32&l[0]&&P!==(P=t[30].name+"")&&x(v,P),44&l[0]&&E!==(E=t[2]===t[27].id&&t[3]===t[30].id)&&y(d,"aria-selected",E),44&l[0]&&L!==(L="underground-selection-item "+(t[2]===t[27].id&&t[3]===t[30].id?"selected":"")+" svelte-lvoly4")&&y(d,"class",L),32&l[0]&&O!==(O=t[27].id)&&y(d,"data-group",O),32&l[0]&&w!==(w=t[30].id)&&y(d,"data-index",w),32&l[0]&&$!==($=t[30].name)&&y(d,"data-name",$),k&&a(k.update)&&32&l[0]&&k.update.call(null,{target:t[29]});},d(t){t&&(p(e),p(l),p(d)),M=!1,o(_);}}}function Lt(t,e){let s,n,i,a,r,l,d,A,E,L,O,w,$=(e[27].name?e[27].name:"")+"",k=e[29];const M=()=>e[14](r,k),_=()=>e[14](null,k);let P=D(e[27].floors),C=[];for(let o=0;o<P.length;o+=1)C[o]=Et(At(e,P,o));return {key:t,first:null,c(){var t,o;s=f("div"),n=f("div"),i=m($),a=g(),r=f("div"),E=g();for(let e=0;e<C.length;e+=1)C[e].c();L=v(),y(n,"class","underground-selection-head svelte-lvoly4"),y(r,"role","tablist"),y(r,"class","underground-selection-body"),y(s,"role","treeitem"),y(s,"aria-selected",l=e[2]===e[27].id),y(s,"class","underground-selection svelte-lvoly4"),y(s,"tabindex",d=e[29]),y(s,"data-group",A=e[27].id),S(s,"left",((null==(t=e[10](e[27].id))?void 0:t[0])||e[8](e[27].centerX))+"px"),S(s,"top",((null==(o=e[10](e[27].id))?void 0:o[1])||e[9](e[27].centerY))+"px"),this.first=s;},m(t,o){h(t,s,o),u(s,n),u(n,i),u(s,a),u(s,r),M(),h(t,E,o);for(let e=0;e<C.length;e+=1)C[e]&&C[e].m(t,o);h(t,L,o),O||(w=[c(e[11].call(null,s)),b(s,"dragstart",$t)],O=!0);},p(t,n){var o,a;if(e=t,32&n[0]&&$!==($=(e[27].name?e[27].name:"")+"")&&x(i,$),k!==e[29]&&(_(),k=e[29],M()),36&n[0]&&l!==(l=e[2]===e[27].id)&&y(s,"aria-selected",l),32&n[0]&&d!==(d=e[29])&&y(s,"tabindex",d),32&n[0]&&A!==(A=e[27].id)&&y(s,"data-group",A),32&n[0]&&S(s,"left",((null==(o=e[10](e[27].id))?void 0:o[0])||e[8](e[27].centerX))+"px"),32&n[0]&&S(s,"top",((null==(a=e[10](e[27].id))?void 0:a[1])||e[9](e[27].centerY))+"px"),4972&n[0]){let t;for(P=D(e[27].floors),t=0;t<P.length;t+=1){const s=At(e,P,t);C[t]?C[t].p(s,n):(C[t]=Et(s),C[t].c(),C[t].m(L.parentNode,L));}for(;t<C.length;t+=1)C[t].d(1);C.length=P.length;}},d(t){t&&(p(s),p(E),p(L)),_(),function(t,e){for(let s=0;s<t.length;s+=1)t[s]&&t[s].d(e);}(C,t),O=!1,o(w);}}}function Ot(t){let e,n=1==t[4]&&St(t);return {c(){n&&n.c(),e=v();},m(t,s){n&&n.m(t,s),h(t,e,s);},p(t,s){1==t[4]?n?n.p(t,s):(n=St(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null);},i:s,o:s,d(t){t&&p(e),n&&n.d(t);}}}function wt(t,{target:e}){e instanceof HTMLElement&&e.appendChild(t);}const $t=()=>!1;function kt(t,e,s){let n,i,o={};!function(){let t=localStorage.getItem("addon-underground-select-positions");t&&(o=JSON.parse(t));}();let a,r,l=[],c=!1;ot.MAPS_ViewSize,ot.MAPS_Size;let d=new Map,u=[];function h(t,e,s){o[t]=[e,s],localStorage.setItem("addon-underground-select-positions",JSON.stringify(o));}function p(t,e,s,n){t instanceof HTMLElement&&(e=Math.round((e+ot.objectViewer.scrollLeft)/ot.MAPS_Scale*100),s=Math.round((s+ot.objectViewer.scrollTop)/ot.MAPS_Scale*100),t.style.left=`${e+n[0]}px`,t.style.top=`${s+n[1]}px`);}function f(t){let e;t.stopPropagation();let s=[0,0];if(t.target instanceof HTMLElement&&(e=t.currentTarget),s=[e.offsetLeft-Math.round((t.touches[0].pageX+ot.objectViewer.scrollLeft)/ot.MAPS_Scale*100),e.offsetTop-Math.round((t.touches[0].pageY+ot.objectViewer.scrollTop)/ot.MAPS_Scale*100)],e instanceof HTMLElement){let t=function(t){p(e,t.touches[0].pageX,t.touches[0].pageY,s);},n=function(){document.removeEventListener("touchmove",t),h(e.dataset.group,e.offsetLeft,e.offsetTop);};document.addEventListener("touchmove",t),window.addEventListener("focus",n,{once:!0}),e.addEventListener("touchend",n,{once:!0});}}function m(t){let e;t.stopPropagation(),t.preventDefault();let s=[0,0];if(t.currentTarget instanceof HTMLElement&&t.target instanceof HTMLElement){if(!t.target.classList.contains("underground-selection-head"))return;e=t.currentTarget;}if(s=[e.offsetLeft-Math.round((t.pageX+ot.objectViewer.scrollLeft)/ot.MAPS_Scale*100),e.offsetTop-Math.round((t.pageY+ot.objectViewer.scrollTop)/ot.MAPS_Scale*100)],e instanceof HTMLElement){let t=function(t){p(e,t.pageX,t.pageY,s);},n=function(){document.removeEventListener("mousemove",t),h(e.dataset.group,e.offsetLeft,e.offsetTop);};document.addEventListener("mousemove",t),window.addEventListener("focus",n,{once:!0}),e.addEventListener("mouseup",n,{once:!0});}}function g(t,e){a!=t||r!=e?(s(2,a=t),s(3,r=e),ot.objectLayerBase.classList.add("grayscale")):(s(2,a=void 0),s(3,r=void 0),ot.objectLayerBase.classList.remove("grayscale"));}!async function(){d.clear();const t=await bt(`${ht}/raw/gh-pages/dist/underground_layers.json`);s(5,u=await t.json()),u.forEach((t=>{t.floors.forEach((async e=>{const s=await bt(e.image_url),n=await s.blob(),i=URL.createObjectURL(n);d.set(`${t.id}-${e.id}`,i);}));}));}();$(et.subscribe((t=>{s(4,c=t);})));return t.$$.update=()=>{1&t.$$.dirty[0]&&(n=l.filter(Boolean));},[l,i,a,r,c,u,d,function(t,{target:e}){setTimeout((()=>{n[e]instanceof HTMLElement&&n[e].appendChild(t);}),1);},function(t){return t+ot.MAPS_RelativeX},function(t){return t+ot.MAPS_RelativeY},function(t){return o[t]||void 0},function(t){pt?t.addEventListener("touchstart",f):t.addEventListener("mousedown",m);},g,()=>{c&&(ot.MAPS_ViewSize,ot.MAPS_Size);},function(t,e){M[t?"unshift":"push"]((()=>{l[e]=t,s(0,l);}));},(t,e,s)=>(s.stopPropagation(),pt||s.preventDefault(),g(t.id,e.id),!1),function(t){M[t?"unshift":"push"]((()=>{i=t,s(1,i);}));}]}class Mt extends J{constructor(t){super(),G(this,t,kt,Ot,r,{redraw:13},null,[-1,-1]);}get redraw(){return this.$$.ctx[13]}}function _t(t){let e,n,i,a,r,l;return {c(){e=f("div"),e.textContent="지하 맵",n=g(),i=f("button"),y(e,"class","maps-addons-switch-label"),y(i,"class",a="maps-addons-switch "+(t[0]?"on":""));},m(s,o){var a;h(s,e,o),h(s,n,o),h(s,i,o),r||(l=[b(i,"click",t[1]),b(i,"contextmenu",(a=Pt,function(t){return t.preventDefault(),a.call(this,t)}))],r=!0);},p(t,[e]){1&e&&a!==(a="maps-addons-switch "+(t[0]?"on":""))&&y(i,"class",a);},i:s,o:s,d(t){t&&(p(e),p(n),p(i)),r=!1,o(l);}}}function Pt(){confirm("지하 지도 선택창 위치를 초기화 하시겠습니까?")&&(alert("지하 지도 선택창 위치가 초기화되었습니다. 새로고침 후 적용됩니다."),localStorage.removeItem("addon-underground-select-positions"));}function Ct(t,e,s){let n;return $(et.subscribe((t=>{var e;s(0,n=t);const i=n?"지하":"지상",o=null==(e=document.querySelector(`#tempMapsTypeList > .point-panel-tag-maps[data-target^="${i}"]`))?void 0:e.getAttribute("data-target");ot.changeMapsType({strCode:ot.MAPS_Type,strTarget:o},ot.MAPS_Type);}))),[n,function(){et.update((t=>!t));}]}class Tt extends J{constructor(t){super(),G(this,t,Ct,_t,r,{});}}const Ht=Symbol("handlers"),It=t=>(t[Ht]=[],t.observe=function(t){this[Ht].push(t);},new Proxy(t,{set(t,e,s,n){const i=Reflect.set(t,e,s,n);return i&&t[Ht].forEach((t=>t(e,s))),i}}));function Nt(t){let e,s,n,i,o,a,r,l,c,d;function m(e){t[3](e);}let v={};void 0!==t[0]&&(v.chestFilter=t[0]),s=new lt({props:v}),M.push((()=>function(t,e,s){const n=t.$$.props[e];void 0!==n&&(t.$$.bound[n]=s,s(t.$$.ctx[n]));}(s,"chestFilter",m)));o=new ut({props:{}}),t[4](o);return r=new Mt({props:{}}),t[5](r),c=new Tt({}),{c(){e=f("div"),B(s.$$.fragment),i=g(),B(o.$$.fragment),a=g(),B(r.$$.fragment),l=g(),B(c.$$.fragment),y(e,"class","maps-addons");},m(t,n){h(t,e,n),F(s,e,null),u(e,i),F(o,e,null),u(e,a),F(r,e,null),u(e,l),F(c,e,null),d=!0;},p(t,[e]){const i={};var a;!n&&1&e&&(n=!0,i.chestFilter=t[0],a=()=>n=!1,P.push(a)),s.$set(i);o.$set({});r.$set({});},i(t){d||(z(s.$$.fragment,t),z(o.$$.fragment,t),z(r.$$.fragment,t),z(c.$$.fragment,t),d=!0);},o(t){U(s.$$.fragment,t),U(o.$$.fragment,t),U(r.$$.fragment,t),U(c.$$.fragment,t),d=!1;},d(n){n&&p(e),X(s),t[4](null),X(o),t[5](null),X(r),X(c);}}}function jt(t,e,s){let n,i,o;function a(){var t;ot.drawMapsLayer=(t=ot.drawMapsLayer,e=>{t(e),function(){if("[object Set]"!=Object.prototype.toString.call(ot.MAPS_ViewPin)||ot.MAPS_ViewPin.size<=0)return;const t=n.getResult(),e=document.getElementById("mapsLayerPoint");ot.MAPS_ViewPin.forEach((s=>{const n=ot.MAPS_PinDraw.get(s);if("[object Array]"!=Object.prototype.toString.call(n)||n.length<=0)return !0;let i=new Map;if(n.forEach((e=>{var s,n;const o=ot.MAPS_PinLoad[e.pin];if(e.category&&o.category[e.category]){const i=o.category[e.category];if((null==(s=o.name)?void 0:s.includes("보물상자"))&&0==t.includes(i.name))return null==(n=document.querySelector(`.maps-point[data-pin="${e.pin}"][data-point="${e.point}"]`))||n.remove(),!0}if(1==ot.MAPS_State.pinGroup){let t=i.get(e.pin);return t=t||{x:0,y:0,state:0,length:0,points:[],point:e},t.x+=e.x,t.y+=e.y,t.points.push(e),t.length++,t.state=e.state?t.state+1:t.state,i.set(e.pin,t),!1}return !0})),ot.MAPS_State.pinGroup){let t={isFilterPinActive:l(tt),isUndergroundMapActive:l(et)};i.forEach((n=>{var i;const o=s.split("/",2);let a,r=0,l=0,c=0,d=0;for(const e of n.points){const s=document.querySelector(`.maps-point[data-pin="${e.pin}"][data-point="${e.point}"]`);s&&s.remove();const n=null==(i=e.tag)?void 0:i.includes("지하");t.isFilterPinActive&&t.isUndergroundMapActive!==n||(e.state&&r++,c+=e.x,d+=e.y,l++);}if(l>1){a=ot.drawPinObject(!0,n.point,o),a.className="maps-point group";let s=document.createElement("p");s.innerText=r+"/"+l,a.querySelector("div").appendChild(s);let i=c/l,u=d/l;a.setAttribute("style","transform: translate("+(i+ot.MAPS_RelativeX)+"px, "+(u+ot.MAPS_RelativeY)+"px);"),a.setAttribute("data-state",r==l?"true":"false"),a.removeAttribute("data-tip"),t.isUndergroundMapActive?a.setAttribute("data-strata","underground"):a.removeAttribute("data-strata"),a.style.marginLeft=a.style.marginTop="-64px",e.appendChild(a);}else for(const t of n.points)a=ot.drawPinObject(!1,t,o),e.appendChild(a);}));}return !0}));}(),o.redraw(),i.removeUnnecessary();}),ot.removePin=function(t){const e=()=>{Q.set(ot.MAPS_PinLoad.filter((t=>{var e;return null==(e=t.name)?void 0:e.includes("보물상자")})).length>0),ot.MAPS_PinLoad=It(ot.MAPS_PinLoad),ot.MAPS_PinLoad.observe(((t,e)=>{var s;"[object Object]"==Object.prototype.toString.call(e)&&(null==(s=e.name)?void 0:s.includes("보물상자"))&&Q.set(!0);}));};return e(),(s,n,i)=>{t(s,n,i),e();}}(ot.removePin);}return w((()=>{a();})),[n,i,o,function(t){n=t,s(0,n);},function(t){M[t?"unshift":"push"]((()=>{i=t,s(1,i);}));},function(t){M[t?"unshift":"push"]((()=>{o=t,s(2,o);}));}]}new class extends J{constructor(t){super(),G(this,t,jt,Nt,r,{});}}({target:document.body,props:{}}),ot.$store={isFilterPinActive:{get:()=>l(tt),set(t){!function(t){tt.set(t);}(t);},toggle(){tt.update((t=>!t));}},isUndergroundMapActive:{get:()=>l(et),set(t){!function(t){et.set(t);}(t);},toggle(){et.update((t=>!t));}},isChestPinLoaded:{get:()=>l(Q),set(t){!function(t){Q.set(t);}(t);},toggle(){Q.update((t=>!t));}}};

})();